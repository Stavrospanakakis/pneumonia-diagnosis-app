FROM node:12.13.0-alpine

# SET THE WORK DIRECTORY
WORKDIR /web

# ADD DEPENDENCIES
RUN yarn global add serve
RUN yarn global add react-scripts

# COPY FILES TO THE WORK DIRECTORY
COPY web .

# INSTALL DEPENDENCIES
RUN yarn

# DEFINE THE PORT
ARG PORT=3000
ENV PORT $PORT

# DEFINE THE INTERNAL INFO
ARG REACT_APP_INTERNAL_IP=localhost
ARG REACT_APP_INTERNAL_PORT=:8000

ENV REACT_APP_INTERNAL_IP $REACT_APP_INTERNAL_IP
ENV REACT_APP_INTERNAL_PORT $REACT_APP_INTERNAL_PORT

# EXPORT THE PORT 
EXPOSE ${PORT}

# RUN SERVER
CMD [ "yarn", "start" ]